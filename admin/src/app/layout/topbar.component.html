<header class="topbar">
  <div class="topbar__left">
    <button mat-icon-button type="button" class="topbar__menu" *ngIf="isHandset" (click)="menuClick.emit()">
      <mat-icon>menu</mat-icon>
    </button>
    <div class="topbar__brand">
      <span class="topbar__logo">EA</span>
      <div class="topbar__brand-text">
        <span class="topbar__brand-name">Ecom Admin</span>
        <span class="topbar__brand-sub">Enterprise Command</span>
      </div>
    </div>
  </div>

  <form class="topbar__search" (ngSubmit)="submit()" novalidate>
    <mat-form-field appearance="outline">
      <mat-label>Global search</mat-label>
      <input matInput [formControl]="searchControl" [placeholder]="placeholder" />
      <button mat-icon-button matSuffix type="submit" aria-label="Search">
        <mat-icon>search</mat-icon>
      </button>
    </mat-form-field>
  </form>

  <div class="topbar__actions">
    <button
      mat-icon-button
      type="button"
      class="topbar__action"
      (click)="toggleTheme.emit()"
      [matTooltip]="isDark ? 'Switch to light mode' : 'Switch to dark mode'"
    >
      <mat-icon>{{ isDark ? 'light_mode' : 'dark_mode' }}</mat-icon>
    </button>
    <button mat-icon-button type="button" class="topbar__action" matTooltip="Notifications">
      <mat-icon>notifications</mat-icon>
    </button>
    <button
      mat-button
      type="button"
      class="topbar__profile"
      [matMenuTriggerFor]="profileMenu"
      *ngIf="user; else anonymous"
    >
      <span class="topbar__avatar" [class.topbar__avatar--image]="!!user?.avatarUrl" [style.background-image]="user?.avatarUrl ? 'url(' + user?.avatarUrl + ')' : ''">
        <ng-container *ngIf="!user?.avatarUrl">{{ avatarInitials }}</ng-container>
      </span>
      <span class="topbar__identity">
        <strong>{{ user?.name || 'Admin' }}</strong>
        <small>{{ user?.email }}</small>
      </span>
      <mat-icon>expand_more</mat-icon>
    </button>
    <ng-template #anonymous>
      <button mat-button type="button" class="topbar__profile" [matMenuTriggerFor]="profileMenu">
        <span class="topbar__avatar">EA</span>
        <span class="topbar__identity">
          <strong>Administrator</strong>
          <small>admin&#64;example.com</small>
        </span>
        <mat-icon>expand_more</mat-icon>
      </button>
    </ng-template>
    <mat-menu #profileMenu="matMenu">
      <button mat-menu-item routerLink="/profile">
        <mat-icon>account_circle</mat-icon>
        <span>Profile</span>
      </button>
      <button mat-menu-item routerLink="/admin/settings">
        <mat-icon>tune</mat-icon>
        <span>Settings</span>
      </button>
      <mat-divider></mat-divider>
      <button mat-menu-item type="button" (click)="logout.emit()">
        <mat-icon>logout</mat-icon>
        <span>Logout</span>
      </button>
    </mat-menu>
  </div>
</header>
