<nav
  class="sidebar"
  [class.sidebar--collapsed]="collapsed"
  [class.sidebar--mobile-open]="mobileOpen"
  [class.sidebar--handset]="handset"
  role="navigation"
  aria-label="Main navigation">
  <div class="sidebar__inner">
    <div class="sidebar__brand">
      <button
        mat-icon-button
        type="button"
        class="sidebar__close"
        *ngIf="handset"
        (click)="closeMobile.emit()"
        aria-label="Close navigation">
        <mat-icon>close</mat-icon>
      </button>

      <div class="sidebar__logo-section">
        <div class="sidebar__logo">
          <mat-icon class="sidebar__logo-icon">inventory_2</mat-icon>
        </div>
        <div class="sidebar__brand-text" *ngIf="!collapsed || handset">
          <span class="sidebar__brand-title">Commerce Admin</span>
          <span class="sidebar__brand-subtitle">Operate at scale</span>
        </div>
      </div>
    </div>

    <div class="sidebar__menu" *ngIf="(items || []).length; else emptyNav">
      <ng-container *ngFor="let section of groupedItems">
        <div class="sidebar__section" *ngIf="section.items.length">
          <div class="sidebar__section-title" *ngIf="!collapsed || handset">
            <span>{{ section.label }}</span>
          </div>
          <a
            *ngFor="let item of section.items; trackBy: trackByRoute"
            [routerLink]="item.route"
            class="sidebar__link"
            routerLinkActive="sidebar__link--active"
            [routerLinkActiveOptions]="item.exact ? { exact: true } : { exact: false }"
            (click)="onNavigate()"
            [matTooltip]="collapsed && !handset ? item.label : ''"
            matTooltipPosition="right"
            [attr.aria-label]="item.label">
            <mat-icon class="sidebar__icon">{{ item.icon }}</mat-icon>
            <span class="sidebar__label">{{ item.label }}</span>
          </a>
        </div>
      </ng-container>
    </div>

    <ng-template #emptyNav>
      <div class="sidebar__empty">
        <mat-icon class="sidebar__empty-icon">menu</mat-icon>
        <span *ngIf="!collapsed || handset">No sections available</span>
      </div>
    </ng-template>

    <div class="sidebar__footer">
      <div class="sidebar__status" *ngIf="!collapsed || handset">
        <div class="sidebar__status-indicator">
          <span class="sidebar__status-dot"></span>
          <div class="sidebar__status-text">
            <span class="sidebar__status-label">Realtime sync</span>
            <small class="sidebar__status-value">All systems nominal</small>
          </div>
        </div>
      </div>

      <button
        mat-icon-button
        type="button"
        class="sidebar__collapse-btn"
        (click)="toggleCollapse.emit()"
        *ngIf="!handset"
        [matTooltip]="collapsed ? 'Expand sidebar' : 'Collapse sidebar'"
        matTooltipPosition="right"
        [attr.aria-label]="collapsed ? 'Expand sidebar' : 'Collapse sidebar'">
        <mat-icon>{{ collapsed ? 'chevron_right' : 'chevron_left' }}</mat-icon>
      </button>
    </div>
  </div>
</nav>
