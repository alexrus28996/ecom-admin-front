<h2 mat-dialog-title>{{ data.location ? 'Edit location' : 'Add location' }}</h2>
<mat-dialog-content class="location-dialog">
  <form [formGroup]="form">
    <mat-form-field appearance="outline">
      <mat-label>Code</mat-label>
      <input matInput formControlName="code" placeholder="Internal code" />
      <mat-error *ngIf="form.controls.code.hasError('required')">Code is required.</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Name</mat-label>
      <input matInput formControlName="name" placeholder="Warehouse name" />
      <mat-error *ngIf="form.controls.name.hasError('required')">Name is required.</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Type</mat-label>
      <mat-select formControlName="type">
        <mat-option *ngFor="let type of locationTypes" [value]="type">{{ type }}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Priority</mat-label>
      <input matInput type="number" formControlName="priority" placeholder="Lower numbers pick first" />
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Metadata (JSON)</mat-label>
      <textarea
        matInput
        formControlName="metadata"
        placeholder="{ &quot;key&quot;: &quot;value&quot; }"
        rows="4"
      ></textarea>
      <mat-hint align="start">Optional JSON object stored with the location.</mat-hint>
      <mat-error *ngIf="form.get('metadata')?.hasError('invalidJson')">
        Metadata must be valid JSON representing an object.
      </mat-error>
    </mat-form-field>

    <mat-slide-toggle formControlName="active">Active</mat-slide-toggle>

    <mat-divider></mat-divider>

    <div class="location-dialog__section" formGroupName="geo">
      <h3>Address (optional)</h3>
      <mat-form-field appearance="outline">
        <mat-label>Address line 1</mat-label>
        <input matInput formControlName="address1" />
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Address line 2</mat-label>
        <input matInput formControlName="address2" />
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>City</mat-label>
        <input matInput formControlName="city" />
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Region / State</mat-label>
        <input matInput formControlName="region" />
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Postal code</mat-label>
        <input matInput formControlName="postalCode" />
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Country</mat-label>
        <input matInput formControlName="country" />
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Latitude</mat-label>
        <input matInput type="number" formControlName="latitude" />
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Longitude</mat-label>
        <input matInput type="number" formControlName="longitude" />
      </mat-form-field>
    </div>

    <mat-divider></mat-divider>

    <mat-form-field appearance="outline">
      <mat-label>Metadata (JSON)</mat-label>
      <textarea matInput rows="4" formControlName="metadata" placeholder='{"region":"North"}'></textarea>
      <mat-hint>Use JSON to store additional key/value data for integrations.</mat-hint>
    </mat-form-field>
  </form>
</mat-dialog-content>
<mat-dialog-actions align="end">
  <button mat-button type="button" (click)="cancel()" [disabled]="saving">Cancel</button>
  <button mat-flat-button color="primary" type="button" (click)="submit()" [disabled]="saving || form.invalid">
    <mat-progress-spinner *ngIf="saving" mode="indeterminate" diameter="18"></mat-progress-spinner>
    <span>Save</span>
  </button>
</mat-dialog-actions>
