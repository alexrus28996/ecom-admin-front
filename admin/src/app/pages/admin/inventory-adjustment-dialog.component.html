<h2 mat-dialog-title>{{ 'inventory.adjustDialog.title' | translate }}</h2>
<<<<<<< ours
<<<<<<< ours
<mat-dialog-content class="adjust-dialog">
  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <mat-form-field appearance="outline" class="adjust-dialog__field">
      <mat-label>{{ 'inventory.adjustDialog.fields.product' | translate }}</mat-label>
      <input
        matInput
        formControlName="productSearch"
        [matAutocomplete]="productAuto"
        [placeholder]="'inventory.adjustDialog.fields.productPlaceholder' | translate"
      />
      <mat-progress-spinner
        *ngIf="form.controls.productId.invalid && form.touched"
        diameter="16"
        mode="indeterminate"
        class="adjust-dialog__spinner"
      ></mat-progress-spinner>
      <mat-autocomplete #productAuto="matAutocomplete" (optionSelected)="onProductSelected($event)" [displayWith]="displayProduct">
        <mat-option *ngFor="let product of productResults$ | async" [value]="product">
          <span class="adjust-dialog__option-name">{{ product.name }}</span>
          <span class="adjust-dialog__option-sku" *ngIf="product.sku">{{ product.sku }}</span>
        </mat-option>
      </mat-autocomplete>
      <mat-error *ngIf="form.controls.productId.invalid">{{ 'inventory.adjustDialog.errors.productRequired' | translate }}</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="adjust-dialog__field">
      <mat-label>{{ 'inventory.adjustDialog.fields.variant' | translate }}</mat-label>
      <mat-select formControlName="variantId" [disabled]="loadingVariants || !variants.length">
        <mat-option value="">{{ 'inventory.adjustDialog.fields.variantAny' | translate }}</mat-option>
        <mat-option *ngFor="let variant of variants" [value]="variant.id">{{ variant.label || variant.id }}</mat-option>
      </mat-select>
      <mat-hint *ngIf="loadingVariants">{{ 'inventory.adjustDialog.loadingVariants' | translate }}</mat-hint>
    </mat-form-field>

    <div class="adjust-dialog__quantity">
      <mat-form-field appearance="outline">
        <mat-label>{{ 'inventory.adjustDialog.fields.quantity' | translate }}</mat-label>
        <input matInput type="number" formControlName="quantity" min="1" />
        <mat-error *ngIf="form.controls.quantity.hasError('required')">{{ 'inventory.adjustDialog.errors.quantityRequired' | translate }}</mat-error>
        <mat-error *ngIf="form.controls.quantity.hasError('min')">{{ 'inventory.adjustDialog.errors.quantityPositive' | translate }}</mat-error>
      </mat-form-field>
<<<<<<< ours
<<<<<<< ours
      <mat-button-toggle-group formControlName="direction" aria-label="{{ 'inventory.adjustDialog.fields.direction' | translate }}">
        <mat-button-toggle value="add">{{ 'inventory.adjustDialog.directions.add' | translate }}</mat-button-toggle>
        <mat-button-toggle value="remove">{{ 'inventory.adjustDialog.directions.remove' | translate }}</mat-button-toggle>
=======
      <mat-button-toggle-group
        formControlName="direction"
        [attr.aria-label]="'inventory.adjustDialog.fields.direction' | translate"
      >
        <mat-button-toggle value="increase">
          {{ 'inventory.adjustDialog.labels.increase' | translate }}
        </mat-button-toggle>
        <mat-button-toggle value="decrease">
          {{ 'inventory.adjustDialog.labels.decrease' | translate }}
        </mat-button-toggle>
>>>>>>> theirs
=======
      <mat-button-toggle-group formControlName="direction" [attr.aria-label]="'inventory.adjustDialog.fields.direction' | translate">
        <mat-button-toggle value="add">{{ 'inventory.adjustDialog.directions.add' | translate }}</mat-button-toggle>
        <mat-button-toggle value="remove">{{ 'inventory.adjustDialog.directions.remove' | translate }}</mat-button-toggle>
>>>>>>> theirs
      </mat-button-toggle-group>
    </div>

    <mat-form-field appearance="outline" class="adjust-dialog__field">
      <mat-label>{{ 'inventory.adjustDialog.fields.reason' | translate }}</mat-label>
      <mat-select formControlName="reason">
        <mat-option *ngFor="let reason of reasons" [value]="reason.value">{{ reason.labelKey | translate }}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline" class="adjust-dialog__field">
      <mat-label>{{ 'inventory.adjustDialog.fields.note' | translate }}</mat-label>
      <textarea matInput formControlName="note" rows="3"></textarea>
    </mat-form-field>

    <div class="adjust-dialog__actions">
      <button mat-button type="button" mat-dialog-close [disabled]="saving">
        {{ 'common.actions.cancel' | translate }}
      </button>
      <button mat-raised-button color="primary" type="submit" [disabled]="saving || form.invalid">
        <mat-progress-spinner *ngIf="saving" mode="indeterminate" diameter="18"></mat-progress-spinner>
        <span>{{ 'inventory.adjustDialog.actions.save' | translate }}</span>
      </button>
    </div>
  </form>
</mat-dialog-content>
=======
=======
>>>>>>> theirs

<mat-dialog-content class="dialog-content" [formGroup]="form">
  <mat-form-field appearance="outline" class="dialog-field full-width">
    <mat-label>{{ 'inventory.adjustDialog.fields.product' | translate }}</mat-label>
    <input
      matInput
      [formControl]="productControl"
      [matAutocomplete]="productAutocomplete"
      [attr.aria-label]="'inventory.adjustDialog.fields.product' | translate"
    />
    <mat-progress-spinner
      *ngIf="loadingProducts"
      matSuffix
      diameter="18"
      mode="indeterminate"
    ></mat-progress-spinner>
    <button
      mat-icon-button
      matSuffix
      type="button"
      aria-label="{{ 'inventory.adjustDialog.actions.clearProduct' | translate }}"
      *ngIf="selectedProduct"
      (click)="clearProductSelection()"
    >
      <mat-icon>close</mat-icon>
    </button>
    <mat-error *ngIf="productControl.hasError('required') && (productControl.dirty || productControl.touched)">
      {{ 'inventory.adjustDialog.validation.productRequired' | translate }}
    </mat-error>
  </mat-form-field>

  <mat-autocomplete
    #productAutocomplete="matAutocomplete"
    [displayWith]="displayProductOption"
    (optionSelected)="onProductSelected($event)"
  >
    <mat-option *ngFor="let option of productOptions" [value]="option">
      <div class="option-title">{{ option.product.name }}</div>
      <div class="option-meta" *ngIf="option.subtitle">
        {{ 'inventory.adjustDialog.labels.sku' | translate }}: {{ option.subtitle }}
      </div>
    </mat-option>
    <mat-option *ngIf="!loadingProducts && !productOptions.length" disabled>
      {{ 'inventory.adjustDialog.emptyStates.noProducts' | translate }}
    </mat-option>
  </mat-autocomplete>

  <ng-container *ngIf="variantOptions.length">
    <mat-form-field appearance="outline" class="dialog-field full-width">
      <mat-label>{{ 'inventory.adjustDialog.fields.variant' | translate }}</mat-label>
      <mat-select formControlName="variantId">
        <mat-option value="">
          {{ 'inventory.adjustDialog.labels.allVariants' | translate }}
        </mat-option>
        <mat-option *ngFor="let variant of variantOptions" [value]="variant._id || variant.id">
          {{ variant.name || variant.sku || variant._id || variant.id }}
        </mat-option>
      </mat-select>
    </mat-form-field>
  </ng-container>

  <div class="dialog-field">
    <span class="field-label">{{ 'inventory.adjustDialog.fields.direction' | translate }}</span>
    <mat-button-toggle-group
      formControlName="direction"
      [attr.aria-label]="'inventory.adjustDialog.fields.direction' | translate"
    >
      <mat-button-toggle value="increase">
        <mat-icon>add</mat-icon>
        {{ 'inventory.adjustDialog.labels.increase' | translate }}
      </mat-button-toggle>
      <mat-button-toggle value="decrease">
        <mat-icon>remove</mat-icon>
        {{ 'inventory.adjustDialog.labels.decrease' | translate }}
      </mat-button-toggle>
    </mat-button-toggle-group>
  </div>

  <mat-form-field appearance="outline" class="dialog-field">
    <mat-label>{{ 'inventory.adjustDialog.fields.quantity' | translate }}</mat-label>
    <input matInput type="number" min="1" formControlName="quantity" />
    <mat-error *ngIf="form.get('quantity')?.hasError('required')">
      {{ 'inventory.adjustDialog.validation.quantityRequired' | translate }}
    </mat-error>
    <mat-error *ngIf="form.get('quantity')?.hasError('min')">
      {{ 'inventory.adjustDialog.validation.quantityPositive' | translate }}
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline" class="dialog-field full-width">
    <mat-label>{{ 'inventory.adjustDialog.fields.reason' | translate }}</mat-label>
    <input matInput formControlName="reason" />
  </mat-form-field>

  <mat-form-field appearance="outline" class="dialog-field full-width">
    <mat-label>{{ 'inventory.adjustDialog.fields.note' | translate }}</mat-label>
    <textarea matInput formControlName="note" rows="2"></textarea>
  </mat-form-field>

  <mat-form-field appearance="outline" class="dialog-field full-width">
    <mat-label>{{ 'inventory.adjustDialog.fields.location' | translate }}</mat-label>
    <input matInput formControlName="location" />
  </mat-form-field>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-stroked-button type="button" (click)="cancel()">
    {{ 'common.actions.cancel' | translate }}
  </button>
  <button mat-flat-button color="primary" type="button" (click)="submit()" [disabled]="form.invalid">
    {{ 'inventory.adjustDialog.actions.submit' | translate }}
  </button>
</mat-dialog-actions>
<<<<<<< ours
>>>>>>> theirs
=======
>>>>>>> theirs
