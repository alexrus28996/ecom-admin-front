<div class="panel">
  <section class="orders-header" style="display:flex;align-items:flex-end;justify-content:space-between;gap:16px;flex-wrap:wrap;">
    <div>
      <h2>{{ 'adminOrders.list.title' | translate }}</h2>
      <p class="muted">{{ 'adminOrders.list.subtitle' | translate }}</p>
    </div>
  </section>

  <section class="table-wrapper">
    <app-loading [show]="loading" labelKey="common.loading"></app-loading>

    <table mat-table [dataSource]="rows" *ngIf="rows.length; else emptyState">
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef>{{ 'adminOrders.list.table.id' | translate }}</th>
        <td mat-cell *matCellDef="let o">{{ o._id || o.id }}</td>
      </ng-container>
      <ng-container matColumnDef="total">
        <th mat-header-cell *matHeaderCellDef>{{ 'adminOrders.list.table.total' | translate }}</th>
        <td mat-cell *matCellDef="let o">{{ o.total | number:'1.2-2' }} {{ o.currency }}</td>
      </ng-container>
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>{{ 'adminOrders.list.table.status' | translate }}</th>
        <td mat-cell *matCellDef="let o">{{ statusKeyFor(o.status) | translate }}</td>
      </ng-container>
      <ng-container matColumnDef="payment">
        <th mat-header-cell *matHeaderCellDef>{{ 'adminOrders.list.table.payment' | translate }}</th>
        <td mat-cell *matCellDef="let o">{{ paymentStatusKeyFor(o.paymentStatus) | translate }}</td>
      </ng-container>
      <ng-container matColumnDef="createdAt">
        <th mat-header-cell *matHeaderCellDef>{{ 'adminOrders.list.table.createdAt' | translate }}</th>
        <td mat-cell *matCellDef="let o">{{ (o.createdAt || o['createdAt']) | date:'short' }}</td>
      </ng-container>
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>{{ 'adminOrders.list.table.actions' | translate }}</th>
        <td mat-cell *matCellDef="let o">
          <button mat-button color="primary" [routerLink]="['/admin/orders', o._id || o.id]">
            <mat-icon>open_in_new</mat-icon>
            {{ 'adminOrders.list.actions.view' | translate }}
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayed"></tr>
      <tr mat-row *matRowDef="let row; columns: displayed"></tr>
    </table>

    <ng-template #emptyState>
      <div class="empty-state">
        <mat-icon>assignment</mat-icon>
        <p>{{ 'adminOrders.list.empty' | translate }}</p>
      </div>
    </ng-template>
  </section>

  <section *ngIf="total > 0">
    <mat-paginator [length]="total" [pageIndex]="pageIndex" [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" (page)="onPage($event)" showFirstLastButtons></mat-paginator>
  </section>

  <app-error-banner [key]="errorKey"></app-error-banner>
</div>
